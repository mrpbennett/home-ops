apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: &app minio-operator
  namespace: argocd
spec:
  destination:
    server: "https://kubernetes.default.svc"
    namespace: *app
  project: default
  source:
    chart: minio-operator
    repoURL: https://operator.min.io
    targetRevision: 4.3.7
    helm:
      valuesObject:
        tenants:
          - name: minio-operator-tenant
            namespace: *app
            imagePullSecret: {}
            scheduler: {}
            pools:
              - servers: 4
                volumesPerServer: 4
                size: 10Gi
                storageClassName: longhorn
                tolerations: {}
                nodeSelector: {}
                affinity: {}
                resources: {}
                securityContext: {}
                topologySpreadConstraints: []
            mountPath: /export
            subPath: /data
            secrets:
              enabled: true
              name: minio-operator-tenant-secret
              accessKey: minio
              secretKey: minio123
            metrics:
              enabled: true
              port: 9000
            certificate:
              externalCaCertSecret: {}
              externalCertSecret: {}
              requestAutoCert: true
              certConfig: {}
            s3:
              bucketDNS: false
            podManagementPolicy: Parallel
            serviceMetadata: {}
            env: {}
            priorityClassName: ""

  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
